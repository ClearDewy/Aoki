import{d as P,r as u,a as h,A as H,p as f,c as v,b as m,e,w as t,f as s,q as J,s as K,o as d,u as V,m as O,k as Q,n as w,h as p,l as W,F as X,v as Y,x as b,B as Z,i as E,j as ee,_ as te}from"./index-3165b167.js";const U=c=>(J("data-v-5a6b86cb"),c=c(),K(),c),le={key:0,id:"register"},oe={class:"register2"},ae=U(()=>m("h2",{style:{"text-align":"left"}},"用户注册",-1)),re={key:1,id:"certification"},se={class:"certification2"},ne=U(()=>m("h2",{style:{"text-align":"left"}},"完善信息",-1)),ie=P({__name:"Register",setup(c){const k=u(!1),o=h({code:"",email:"",major:"",name:"",password:"",role:2,username:""}),C=u(),B=h({email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱"}],code:[{required:!0,message:"请输入验证码",trigger:"blur"},{len:6,message:"请输入正确验证码"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:31,message:"密码不少于6位不大于31位"}]}),z=async r=>{r&&await r.validate((l,_)=>{l&&f.verifyCode(o.email,o.code).then(n=>{k.value=!0}).catch(n=>{b("验证码错误")})})},g=u(!1),j=u(Date.now()),I=()=>{f.getVerifyCode(o.email).then(r=>{j.value=Date.now()+1e3*60,g.value=!0}).catch(r=>{b("验证码发送失败")})},S=()=>{g.value=!1},x=u([]),R=u(),A=h({name:[{required:!0,message:"请输入姓名",trigger:"blur"}],rule:[{required:!0,message:"请选择身份",trigger:"blur"}],username:[{required:!0,message:"请输入学工号",trigger:"blur"}],major:[{required:!0,message:"请选择专业",trigger:"blur"}]}),L=async r=>{r&&await r.validate((l,_)=>{l&&f.register(o).then(n=>{Z("注册成功"),E.replace(ee.Login)}).catch(n=>{b("注册失败")})})};return H(()=>{f.getAllMajor().then(r=>{r&&(x.value=r.data),console.log(x.value)})}),(r,l)=>{const _=s("el-icon"),n=s("el-input"),i=s("el-form-item"),N=s("el-countdown"),y=s("el-button"),D=s("router-link"),q=s("el-form"),F=s("el-radio"),G=s("el-radio-group"),M=s("el-option"),T=s("el-select");return k.value?(d(),v("div",re,[m("div",se,[m("div",null,[ne,e(q,{ref_key:"ruleFormRef2",ref:R,model:o,rules:A},{default:t(()=>[e(i,{prop:"name"},{default:t(()=>[e(n,{modelValue:o.name,"onUpdate:modelValue":l[4]||(l[4]=a=>o.name=a),style:{width:"280px",height:"40px","margin-top":"20px"},placeholder:"请输入真实姓名"},null,8,["modelValue"])]),_:1}),e(i,{prop:"rule"},{default:t(()=>[e(G,{modelValue:o.role,"onUpdate:modelValue":l[5]||(l[5]=a=>o.role=a),style:{"margin-top":"20px"}},{default:t(()=>[e(F,{label:1},{default:t(()=>[p("教师")]),_:1}),e(F,{label:2},{default:t(()=>[p("学生")]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(i,{prop:"username"},{default:t(()=>[e(n,{modelValue:o.username,"onUpdate:modelValue":l[6]||(l[6]=a=>o.username=a),style:{width:"280px",height:"40px","margin-top":"20px"},placeholder:"请输入学工号"},null,8,["modelValue"])]),_:1}),e(i,{prop:"major"},{default:t(()=>[e(T,{modelValue:o.major,"onUpdate:modelValue":l[7]||(l[7]=a=>o.major=a),placeholder:"请选择专业",style:{width:"280px","margin-top":"20px"},class:"select_major"},{default:t(()=>[(d(!0),v(X,null,Y(x.value,(a,$)=>(d(),w(M,{key:$,value:a,label:a},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(i,null,{default:t(()=>[e(y,{type:"primary",onClick:l[8]||(l[8]=a=>L(R.value)),style:{width:"280px",height:"40px","margin-top":"20px"}},{default:t(()=>[p("完成 ")]),_:1})]),_:1})]),_:1},8,["model","rules"])])])])):(d(),v("div",le,[m("div",oe,[m("div",null,[ae,e(q,{ref_key:"ruleFormRef1",ref:C,model:o,"label-width":"",rules:B},{default:t(()=>[e(i,{prop:"email"},{default:t(()=>[e(n,{modelValue:o.email,"onUpdate:modelValue":l[0]||(l[0]=a=>o.email=a),style:{width:"280px",height:"40px","margin-top":"20px"},placeholder:"请输入邮箱"},{prefix:t(()=>[e(_,{style:{"font-size":"18px"}},{default:t(()=>[e(V(O))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(i,{prop:"code"},{default:t(()=>[e(n,{modelValue:o.code,"onUpdate:modelValue":l[1]||(l[1]=a=>o.code=a),style:{width:"280px",height:"40px","margin-top":"20px"},placeholder:"请输入验证码"},{prefix:t(()=>[e(_,{style:{"font-size":"18px"}},{default:t(()=>[e(V(Q))]),_:1})]),_:1},8,["modelValue"]),g.value?(d(),w(N,{key:0,format:"ss",value:j.value,style:{position:"absolute",right:"10px",top:"24px"},"value-style":"color:#409eff;font-size: 14px",onFinish:S},null,8,["value"])):(d(),w(y,{key:1,style:{position:"absolute",right:"10px",top:"24px"},type:"text",onClick:I},{default:t(()=>[p("获取验证码 ")]),_:1}))]),_:1}),e(i,{prop:"password"},{default:t(()=>[e(n,{modelValue:o.password,"onUpdate:modelValue":l[2]||(l[2]=a=>o.password=a),style:{width:"280px",height:"40px","margin-top":"20px"},placeholder:"密码","show-password":""},{prefix:t(()=>[e(_,{style:{"font-size":"18px"}},{default:t(()=>[e(V(W))]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(i,null,{default:t(()=>[e(y,{type:"primary",onClick:l[3]||(l[3]=a=>z(C.value)),style:{width:"280px",height:"40px","margin-top":"20px"}},{default:t(()=>[p("下一步 ")]),_:1})]),_:1}),e(D,{to:"/login",type:"primary",underline:!1,style:{float:"left"}},{default:t(()=>[p(">返回")]),_:1})]),_:1},8,["model","rules"])])])]))}}});const de=te(ie,[["__scopeId","data-v-5a6b86cb"]]);export{de as default};
