import{e as S}from"./style-da0850c1.js";import{d as de,r as p,a as N,L as s,c as E,b as i,e,w as a,u as o,p as M,x as r,f as n,o as f,h,U as I,m as re,k as ce,n as D,C as ue,S as pe,D as w,E as _e,G as me,H as fe,I as he,P as ge,R as B,B as k,i as F,z as Y,j as ve,q as ye,s as be,J as xe,_ as we}from"./index-f12f2e9c.js";const _=g=>(ye("data-v-1bd32fe5"),g=g(),be(),g),ke={style:{display:"flex",width:"100%",height:"100%"}},Le={style:{width:"30%",height:"100%","margin-right":"10px"}},Ve={class:"card-header"},Ce=_(()=>i("span",null,"选课时间设置",-1)),Te=_(()=>i("div",{class:"card-header",style:{"justify-content":"center"}},[i("span",null,"删除课程")],-1)),Ue={style:{height:"100%",width:"100%",display:"flex","justify-content":"center","align-items":"center"}},ze={style:{width:"100%"}},Re={style:{position:"relative"}},Se={class:"card-header"},Me=_(()=>i("span",null,"课程信息设置",-1)),Ie=_(()=>i("div",{class:"separator hidden-md-and-down"},null,-1)),De=_(()=>i("p",null,null,-1)),Be=_(()=>i("div",{class:"el-upload__text"},[h(" 把图像拖放到此处 "),i("em",null,"单击此处")],-1)),je={key:1,style:{width:"288px",height:"156px",display:"inline-block"}},Ae=de({__name:"LessonSetting",setup(g){const m=p(["",""]),v=p(""),L=p(!1),j=p(Date.now()),q=()=>{M.getTopicTime(s.value.id).then(t=>{m.value=[t.data.beginTime,t.data.endTime]}).catch(t=>{r("获取选课时间失败")})};p(!1);const u=N({id:s.value.id,name:s.value.name,introduction:s.value.introduction,avatarURL:s.value.avatarURL}),G=p(),H=N({name:[{required:!0,message:"请输入课程名",trigger:"blur"}],teamMode:[{required:!0,message:"请选择团队模式",trigger:"blur"}]}),y=p(""),O={viewMode:1,dragMode:"move",width:240,height:130,cropBoxResizable:!1,aspectRatio:24/13},V=p(!1),P=(t,l)=>{var d;if(!((d=t.raw)!=null&&d.type.startsWith("image/")))return r("上传必须为图片"),!1;if(t.size&&t.size>1024*1024*2)return r("上传头像图片大小不能超过 2MB"),!1;y.value=URL.createObjectURL(t.raw)},J=()=>{var t;(t=w)==null||t.rotate(-90)},W=()=>{var t;(t=w)==null||t.rotate(90)},A=()=>{y.value=""},K=()=>{var t;V.value=!0,(t=w)==null||t.getBlob().then(l=>{if(!l){r("图片获取为空");return}console.log(l.type);let d=new window.File([l],"LessonAvatar.png");xe.uploadAvatar(d).then(b=>{u.avatarURL=b.data,k("头像上传成功"),A()}).catch(b=>{r("头像上传失败")})}).catch(l=>{r(l.toString()),r("图片加载失败")}),V.value=!1},Q=()=>{B.updateLesson(u).then(t=>{te(),k("保存成功")}).catch(t=>{r("保存失败")})},X=()=>{B.updateTopicTime({beginTime:m.value[0],endTime:m.value[1],lessonId:s.value.id}).then(t=>{k("保存成功")}).catch(t=>{r("保存失败")})},Z=()=>{M.getVerifyCode(I.value.email).then(t=>{j.value=Date.now()+1e3*60,L.value=!0})},$=()=>{L.value=!1},ee=()=>{B.deleteLesson(s.value.id,v.value).then(t=>{k("删除成功"),F.replace("/")}).catch(t=>{r("删除失败")})},te=()=>{M.getLesson(s.value.id).then(t=>{t&&(s.value=t.data,s.value.ownerName=Y.getItem("Lesson").ownerName,Y.setItem("Lesson",s.value),F.push(ve.Lesson))}).catch(t=>{r("刷新课程失败")})};return s.value.topicMode||q(),(t,l)=>{const d=n("el-button"),b=n("el-date-picker"),C=n("el-card"),T=n("el-icon"),U=n("el-input"),ae=n("el-countdown"),z=n("el-form-item"),le=n("el-image"),R=n("el-col"),oe=n("el-upload"),x=n("el-tooltip"),se=n("el-space"),ne=n("el-row"),ie=n("el-form");return f(),E("div",ke,[i("div",Le,[e(C,{style:{height:"20%",width:"100%","margin-bottom":"10px"},"body-style":o(S)},{header:a(()=>[i("div",Ve,[Ce,e(d,{class:"button",disabled:o(s).topicMode,onClick:X,type:"primary"},{default:a(()=>[h("保存")]),_:1},8,["disabled"])])]),default:a(()=>[e(b,{modelValue:m.value,"onUpdate:modelValue":l[0]||(l[0]=c=>m.value=c),type:"datetimerange","start-placeholder":"Start Date","end-placeholder":"End Date","value-format":"YYYY-MM-DD HH:mm:ss",disabled:o(s).topicMode},null,8,["modelValue","disabled"])]),_:1},8,["body-style"]),e(C,{style:{height:"80%",width:"100%","margin-top":"10px"},"body-style":o(S)},{header:a(()=>[Te]),default:a(()=>[i("div",Ue,[i("div",ze,[e(U,{modelValue:o(I).email,"onUpdate:modelValue":l[1]||(l[1]=c=>o(I).email=c),disabled:!0,style:{width:"100%",height:"40px","margin-top":"20px"},placeholder:"请输入邮箱"},{prefix:a(()=>[e(T,{style:{"font-size":"18px"}},{default:a(()=>[e(o(re))]),_:1})]),_:1},8,["modelValue"]),i("div",Re,[e(U,{modelValue:v.value,"onUpdate:modelValue":l[2]||(l[2]=c=>v.value=c),style:{width:"100%",height:"40px","margin-top":"20px"},placeholder:"请输入验证码"},{prefix:a(()=>[e(T,{style:{"font-size":"18px"}},{default:a(()=>[e(o(ce))]),_:1})]),_:1},8,["modelValue"]),L.value.value?(f(),D(ae,{key:0,format:"ss",value:j.value,style:{position:"absolute",right:"10px",top:"24px"},"value-style":"color:#409eff;font-size: 14px",onFinish:$},null,8,["value"])):(f(),D(d,{key:1,style:{position:"absolute",right:"10px",top:"24px"},type:"text",onClick:Z},{default:a(()=>[h("获取验证码 ")]),_:1}))]),e(d,{type:"danger",onClick:ee,style:{width:"80%",height:"40px",margin:"10%"},disabled:v.value.length!==6},{default:a(()=>[h("删除")]),_:1},8,["disabled"])])])]),_:1},8,["body-style"])]),e(C,{style:{width:"70%",height:"100%","margin-left":"10px"},"body-style":o(S)},{header:a(()=>[i("div",Se,[Me,e(d,{class:"button",onClick:Q,type:"primary"},{default:a(()=>[h("保存")]),_:1})])]),default:a(()=>[e(ie,{ref_key:"ruleFormRef",ref:G,model:u,"label-width":"120px",rules:H,"label-position":"top",inline:!0},{default:a(()=>[e(z,{label:"课程名",prop:"name"},{default:a(()=>[e(U,{modelValue:u.name,"onUpdate:modelValue":l[3]||(l[3]=c=>u.name=c),placeholder:"请输入课程名"},null,8,["modelValue"])]),_:1}),e(z,{label:"课程头像"},{default:a(()=>[e(ne,{style:{width:"100%"}},{default:a(()=>[e(R,{span:11,style:{display:"flex","align-items":"center","justify-content":"center"}},{default:a(()=>[e(le,{src:u.avatarURL,style:{height:"130px",width:"240px"}},null,8,["src"])]),_:1}),e(R,{span:2},{default:a(()=>[Ie,De]),_:1}),e(R,{span:11},{default:a(()=>[y.value?(f(),E("div",je,[e(o(pe),{ref_key:"cropper",ref:w,options:O,img:y.value,type:"image/png"},null,8,["img"]),e(se,null,{default:a(()=>[e(x,{class:"item",effect:"dark",content:"向左旋转90°",trigger:"hover",placement:"bottom"},{default:a(()=>[e(d,{onClick:J,icon:o(_e),size:"small"},null,8,["icon"])]),_:1}),e(x,{class:"item",effect:"dark",content:"向右旋转90°",trigger:"hover",placement:"bottom"},{default:a(()=>[e(d,{onClick:W,icon:o(me),size:"small"},null,8,["icon"])]),_:1}),e(x,{class:"item",effect:"dark",content:"关闭图像截取",trigger:"hover",placement:"bottom"},{default:a(()=>[e(d,{onClick:A,icon:o(fe),size:"small"},null,8,["icon"])]),_:1}),e(x,{class:"item",effect:"dark",trigger:"hover",content:"确定图像截取",placement:"bottom"},{default:a(()=>[e(d,{onClick:K,icon:o(he),size:"small",loading:V.value},null,8,["icon","loading"])]),_:1})]),_:1})])):(f(),D(oe,{key:0,class:"upload-demo",drag:"",action:"","auto-upload":!1,"show-file-list":!1,"on-change":P,accept:"image/*"},{default:a(()=>[e(T,{size:67},{default:a(()=>[e(o(ue))]),_:1}),Be]),_:1}))]),_:1})]),_:1})]),_:1}),e(z,{label:"课程描述"},{default:a(()=>[e(ge,{modelValue:u.introduction,"onUpdate:modelValue":l[4]||(l[4]=c=>u.introduction=c)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["body-style"])])}}});const Fe=we(Ae,[["__scopeId","data-v-1bd32fe5"]]);export{Fe as default};
