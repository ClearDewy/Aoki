import{d as H,r as u,c as B,b as r,e,w as a,u as m,F as S,p as h,L as N,U as A,x as i,f as d,o as _,n as L,h as b,V as J,K as O,v as P,a4 as Q,q as W,s as X,_ as Y}from"./index-3165b167.js";import{e as R}from"./style-297731c9.js";const I=y=>(W("data-v-747497ea"),y=y(),X(),y),Z={style:{display:"flex",width:"100%",height:"100%"}},ee={class:"box-card",style:{"padding-right":"1%"}},ae={class:"card-header"},le=I(()=>r("span",null,"我的团队",-1)),te={class:"card-header"},oe=I(()=>r("span",null,"未加入团队",-1)),se=I(()=>r("div",{class:"card-header"},[r("span",null,"团队列表")],-1)),ne={class:"dialog-footer"},de=H({__name:"Team",setup(y){const $=u([]),D=o=>{console.log(o)},p=u(!1),g=u(""),x=u(!1),c=u(),V=u([]),k=u([]),w=()=>{h.getTeams(N.value.id).then(o=>{V.value=o.data;for(const t of V.value)for(const n of t.memberList)if(n.username===A.value.username){c.value=t;return}}).catch(o=>{i(o),i("获取团队列表失败")})},v=()=>{h.getNoTeamMembers(N.value.id).then(o=>{k.value=o.data}).catch(o=>{i("获取未加入团队成员列表失败")})},F=()=>{h.createTeam(g.value,N.value.id).then(o=>{p.value=!1,w(),v()}).catch(o=>{i("创建团队失败")})},q=o=>{c.value&&h.addTeamMember(c.value.id,o).then(t=>{w(),v()}).catch(t=>{i("添加用户失败")})},E=o=>{var t;h.removeTeamMember((t=c.value)==null?void 0:t.id,o).then(n=>{w(),v()}).catch(n=>{i("删除团队成员失败")})};return w(),v(),(o,t)=>{const n=d("el-button"),T=d("el-avatar"),s=d("el-table-column"),C=d("el-table"),U=d("el-card"),K=d("el-collapse-item"),j=d("el-collapse"),G=d("el-input"),z=d("el-dialog");return _(),B(S,null,[r("div",Z,[r("div",ee,[e(U,{class:"box-card-half",style:{"margin-bottom":"2%"},"body-style":m(R)},{header:a(()=>[r("div",ae,[le,c.value?(_(),L(n,{key:0,class:"button",text:"",onClick:t[0]||(t[0]=l=>x.value=!0)},{default:a(()=>[b("添加成员")]),_:1})):(_(),L(n,{key:1,class:"button",text:"",onClick:t[1]||(t[1]=l=>p.value=!0)},{default:a(()=>[b("创建团队")]),_:1}))])]),default:a(()=>{var l;return[e(C,{data:(l=c.value)==null?void 0:l.memberList,"show-header":!1,style:{height:"100%"}},{default:a(()=>{var f;return[e(s,{prop:"avatarURL",label:"头像"},{default:a(M=>[e(T,{src:M.row.avatarURL,fit:"scale-down",size:"small"},null,8,["src"])]),_:1}),e(s,{prop:"name",label:"姓名"}),e(s,{prop:"username",label:"学号"}),((f=c.value)==null?void 0:f.ownerName)===m(A).name?(_(),L(s,{key:0,label:"编辑",width:"60"},{default:a(({row:M})=>[e(n,{type:"danger",icon:m(J),circle:"",onClick:re=>E(M.id)},null,8,["icon","onClick"])]),_:1})):O("",!0)]}),_:1},8,["data"])]}),_:1},8,["body-style"]),e(U,{class:"box-card-half",style:{"margin-top":"2%"},"body-style":m(R)},{header:a(()=>[r("div",te,[oe,e(n,{class:"button",text:"",onClick:v},{default:a(()=>[b("刷新")]),_:1})])]),default:a(()=>[e(C,{data:k.value,"show-header":!1,style:{height:"100%"}},{default:a(()=>[e(s,{prop:"avatarURL",label:"头像"},{default:a(l=>[e(T,{src:l.row.avatarURL,fit:"scale-down",size:"small"},null,8,["src"])]),_:1}),e(s,{prop:"name",label:"姓名"}),e(s,{prop:"username",label:"学号"})]),_:1},8,["data"])]),_:1},8,["body-style"])]),e(U,{class:"box-card","body-style":m(R)},{header:a(()=>[se]),default:a(()=>[e(j,{modelValue:$.value,"onUpdate:modelValue":t[2]||(t[2]=l=>$.value=l),onChange:D},{default:a(()=>[(_(!0),B(S,null,P(V.value,l=>(_(),L(K,{title:l.name,name:l.id},{default:a(()=>[e(C,{data:l.memberList,"show-header":!1,style:{height:"100%"}},{default:a(()=>[e(s,{prop:"avatarURL",label:"头像"},{default:a(f=>[e(T,{src:f.row.avatarURL,fit:"scale-down",size:"small"},null,8,["src"])]),_:1}),e(s,{prop:"name",label:"姓名"}),e(s,{prop:"username",label:"学号"})]),_:2},1032,["data"])]),_:2},1032,["title","name"]))),256))]),_:1},8,["modelValue"])]),_:1},8,["body-style"])]),e(z,{modelValue:p.value,"onUpdate:modelValue":t[5]||(t[5]=l=>p.value=l),title:"创建团队",width:"30%",center:"","align-center":""},{footer:a(()=>[r("span",ne,[e(n,{onClick:t[4]||(t[4]=l=>p.value=!1)},{default:a(()=>[b("Cancel")]),_:1}),e(n,{type:"primary",onClick:F,disabled:g.value.length===0},{default:a(()=>[b(" Confirm ")]),_:1},8,["disabled"])])]),default:a(()=>[e(G,{modelValue:g.value,"onUpdate:modelValue":t[3]||(t[3]=l=>g.value=l),placeholder:"请输入团队名",clearable:""},null,8,["modelValue"])]),_:1},8,["modelValue"]),e(z,{modelValue:x.value,"onUpdate:modelValue":t[6]||(t[6]=l=>x.value=l),title:"添加成员",width:"30%",center:"","align-center":"",style:{"min-width":"500px","max-height":"80%"}},{default:a(()=>[e(C,{data:k.value,"show-header":!1,style:{height:"100%"}},{default:a(()=>[e(s,{prop:"avatarURL",label:"头像"},{default:a(l=>[e(T,{src:l.row.avatarURL,fit:"scale-down",size:"small"},null,8,["src"])]),_:1}),e(s,{prop:"name",label:"姓名"}),e(s,{prop:"username",label:"学号"}),e(s,{label:"编辑",width:"60"},{default:a(l=>[e(n,{icon:m(Q),type:"primary",circle:"",onClick:f=>q(l.row.id)},null,8,["icon","onClick"])]),_:1})]),_:1},8,["data"])]),_:1},8,["modelValue"])],64)}}});const me=Y(de,[["__scopeId","data-v-747497ea"]]);export{me as default};
